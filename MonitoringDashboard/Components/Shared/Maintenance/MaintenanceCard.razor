@using MonitoringDashboard.Data.Models
@using MonitoringDashboard.Helpers

<div class="relative w-full bg-neutral-800 p-4 flex flex-col gap-y-4 rounded-sm shadow-lg border-s-4 border-1 border-zinc-700">
    <!-- Header: Title + Status -->
    <div class="flex flex-wrap items-center gap-3 justify-between">
        <div class="flex items-center gap-3">
            <span class="text-2xl font-semibold">@Maintenance.Title</span>

            @if (Maintenance.Status == MaintenanceStatus.InProgress)
            {
                <span class="px-2 py-1 bg-yellow-500 text-yellow-100 rounded-sm text-sm font-semibold">Ongoing</span>
            }
            else if (Maintenance.Status == MaintenanceStatus.Scheduled)
            {
                <span class="px-2 py-1 bg-blue-600 text-blue-100 rounded-sm text-sm font-semibold">Scheduled</span>
            }
        </div>

        <!-- Severity -->
        <span class="px-2 py-1 rounded-sm text-sm font-semibold"
              style="@($"background-color:{GetSeverityColor(Maintenance.Severity)};color:white;")">
            @Maintenance.Severity
        </span>
    </div>

    <!-- Description -->
    @if (!string.IsNullOrWhiteSpace(Maintenance.Description))
    {
        <div class="text-zinc-300 whitespace-pre-line">
            @Maintenance.Description
        </div>
    }

    <!-- Times -->
    <div class="flex flex-col gap-1 text-sm text-zinc-400">
        <span>
            <strong>Start:</strong> @Maintenance.StartTime.ToLocalTime().ToString("f")
        </span>
        <span>
            <strong>End:</strong> @Maintenance.EndTime.ToLocalTime().ToString("f")
        </span>
        <span>
            <strong>Duration:</strong> @((Maintenance.EndTime - Maintenance.StartTime).ToReadableString())
        </span>
    </div>

    <!-- Related Services -->
    @if (Maintenance.MonitoredServices?.Any() == true)
    {
        <div class="flex flex-wrap items-center gap-2 text-sm text-zinc-300">
            <strong>Affected Services:</strong>
            @foreach (var service in Maintenance.MonitoredServices)
            {
                <span class="px-2 py-1 bg-zinc-700 rounded-sm">@service.Name</span>
            }
        </div>
    }
</div>

@code {
    [Parameter]
    public Maintenance Maintenance { get; set; } = default!;

    private string GetSeverityColor(MaintenanceSeverity severity) => severity switch
    {
        MaintenanceSeverity.Minor => "#22c55e",
        MaintenanceSeverity.Major => "#eab308",
        MaintenanceSeverity.Critical => "#dc2626",
        _ => "#6b7280"
    };
}

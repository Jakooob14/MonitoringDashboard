@page "/"
@using MonitoringDashboard.Data
@using MonitoringDashboard.Services
@inject AppDbContext Db
@inject ServiceChecker ServiceChecker
@inject NavigationManager NavigationManager
@inject IServiceScopeFactory ScopeFactory
@rendermode InteractiveServer

<PageTitle>Home</PageTitle>

<section class="container mx-auto mt-12">
    <section class="bg-zinc-800 p-4 rounded-xl mt-4 text-2xl font-bold">
        @if (GetFailedServicesCount() > 0)
        {
            int failedCount = GetFailedServicesCount();
            <span>@failedCount service@(failedCount > 1 ? "s are" : " is") currently down</span>
        } else {
            <span>All services are operational</span>
        }
    </section>
    
    <section class="mt-8">
        <h2 class="text-4xl">Services</h2>
        <NavLink href="/add-monitored-service">Add monitored service</NavLink>
        <div class="flex flex-col gap-y-4 mt-4">
            @foreach (var monitoredService in _monitoredServices)
            {
                <MonitoredServiceCard MonitoredService="monitoredService"/>
            }
        </div>
    </section>
</section>